var si_refresh_timeout=0;function setHeading(a){var b;if(si_global.mode=="ap"){b=$.l10n._("Access Point")+" &nbsp; &nbsp; &nbsp; &nbsp; "+a.mac}else{b=$.l10n._("Station")+" &nbsp; &nbsp; &nbsp; &nbsp; "+a.mac;if(a.aprepeater!=0){b+=" ("+$.l10n._("AP-Repeater")+")"}b+=" &nbsp; &nbsp; [ "+a.associd+" ]"}$("#si_heading").html(b)}function setAck(f,e){var d=(e<150)?150:e;var b=toFixed(d/1000,1);var a=toFixed(d/1609.344,1);var c=[a,"miles","("+b,"km)"];$("#si_ack").text(c.join(" "))}function decodeAirMaxPri(b){var a;switch(b){case 0:a=$.l10n._("High");break;case 1:a=$.l10n._("Medium");break;case 2:a=$.l10n._("Low");break;default:a=$.l10n._("None")}return a}function formatRate(a){if(a>0){return""+toFixed(a,1)+" Mbps"}else{return" - "}}function formatBytes(a){var b=""+a;if(a>1024*1024*1024){b+=" ("+toFixed(a/(1024*1024*1024),2)+" GBytes)"}else{if(a>1024*1024){b+=" ("+toFixed(a/(1024*1024),2)+" MBytes)"}else{if(a>1024){b+=" ("+toFixed(a/1024,2)+" kBytes)"}}}return b}function fillRates(b){$("#si_rate_tbl > tbody").empty();var a=[];for(var c=0;c<b.rates.length;++c){var e=[];e.push("<tr>");e.push('<td align="center">'+b.rates[c]+"</td>");var d=(b.signals[c]!=0&&b.signals[c]!=-96)?b.signals[c]:$.l10n._("N/A");e.push('<td align="center">'+d+"</td>");e.push("</tr>");a.push(e.join(""))}$("#si_rate_tbl > tbody").append(a.join(""))}function loadStaInfo(b){if(b.length!=1){$("#si_details").hide();$("#si_kick").hide();if(si_global.sta_mac!="00:00:00:00:00:00"){$("#si_heading").text("[ "+si_global.sta_mac+" ] "+$.l10n._("Not Associated"))}else{$("#si_heading").text($.l10n._("Not Associated"))}return}var a=b[0];setHeading(a);$("#si_name").text(a.name.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"));$("#si_uptime").text(secsToCountdown(a.uptime,$.l10n._("day"),$.l10n._("days")));$("#si_signal").text(""+a.signal+" dBm");$("#si_noise").text(""+a.noisefloor+" dBm");if(si_global.autoack){setAck(a.ack,a.distance)}$("#si_ack_row").toggle(si_global.autoack);$("#si_ccq").text((a.ccq>0)?""+a.ccq+"%":"-");if(si_global.airmax_on){$("#si_amp").text(decodeAirMaxPri(a.airmax.priority));$("#si_amq").text(""+a.airmax.quality+"%");$("#si_amc").text(""+a.airmax.capacity+"%")}$(".si_airmax").toggle(si_global.airmax_on);if(si_global.airmax_on&&si_global.phased_array){$("#si_beam").html((a.airmax.beam<si_global.beam_angles.length?si_global.beam_angles[a.airmax.beam]:si_global.beam_angles[si_global.beam_angles.length-1]))}$(".si_airbeam").toggle(si_global.airmax_on&&si_global.phased_array);if(a.lastip!="0.0.0.0"){$("#si_lastip").html('<a href="http://'+a.lastip+'" target="_blank">'+a.lastip+"</a>")}else{$("#si_lastip").text($.l10n._("unknown"))}$("#si_rate").text(formatRate(a.tx)+" / "+formatRate(a.rx));$("#si_packets").text(""+a.stats.tx_data+" / "+a.stats.rx_data);$("#si_packet_rate").text(""+a.stats.tx_pps+" / "+a.stats.rx_pps);$("#si_txbytes").text(formatBytes(a.stats.tx_bytes));$("#si_rxbytes").text(formatBytes(a.stats.rx_bytes));fillRates(a);$("#si_details").show();if(a.aprepeater==0){$("#si_kick").disable(0).show()}}function handleError(b,c,a){if(b&&b.status!=200&&b.status!=0){window.location.reload()}}function refreshStaInfo(){var a={};a.ifname=si_global.ifname;a.sta_mac=si_global.sta_mac;$.ajax({cache:false,url:"/sta.cgi",data:a,dataType:"json",success:loadStaInfo,error:handleError,complete:function(c,b){if(typeof refreshContent!="function"){if(si_refresh_timeout){clearTimeout(si_refresh_timeout)}si_refresh_timeout=setTimeout(refreshStaInfo,5000)}}});return false}function refreshAll(){if(typeof reloadStatus=="function"){reloadStatus()}refreshStaInfo()}function kickEnd(a,c,b){refreshStaInfo()}function kickStation(){$("#si_kick").disable();jQuery.ajax({url:kick_url,cache:false,dataType:"json",success:kickEnd,error:handleError});return false}$(document).ready(function(){$.l10n.init({dictionary:l10n_stainfo});$("#si_details").hide();$("#si_kick").hide();if(!window.opener){$("#si_close").hide()}refreshStaInfo()});